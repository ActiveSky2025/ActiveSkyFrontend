<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Detalle del Lugar - ActiveSky</title>
  <link rel="icon" type="image/png" sizes="32x32" href="../assets/images/logo.jpg">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="../css/styles.css">
  <style>
    /* Estilos espec√≠ficos para spot detail */
    .spot-hero {
      height: 400px;
      background-size: cover;
      background-position: center;
      border-radius: 16px;
      position: relative;
      overflow: hidden;
      margin-bottom: 24px;
    }

    .spot-hero::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 50%;
      background: linear-gradient(to top, rgba(0,0,0,0.7), transparent);
    }

    .spot-hero-content {
      position: absolute;
      bottom: 24px;
      left: 24px;
      right: 24px;
      z-index: 1;
      color: white;
    }

    .spot-hero-title {
      font-size: 2.5rem;
      font-weight: bold;
      margin-bottom: 8px;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
    }

    .spot-rating-badge {
      background: rgba(255,255,255,0.9);
      color: #333;
      padding: 8px 16px;
      border-radius: 24px;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      font-weight: bold;
    }

    .star-rating-display {
      color: #ffc107;
      font-size: 1.2rem;
    }

    .info-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 16px;
      margin: 24px 0;
    }

    .info-item {
      background: var(--gray-100);
      padding: 16px;
      border-radius: var(--border-radius);
      text-align: center;
    }

    .info-item-icon {
      font-size: 2rem;
      margin-bottom: 8px;
    }

    .info-item-label {
      font-size: 0.85rem;
      color: var(--gray-600);
      margin-bottom: 4px;
    }

    .info-item-value {
      font-size: 1.1rem;
      font-weight: bold;
      color: #333;
    }

    .spot-map {
      height: 300px;
      border-radius: var(--border-radius);
      overflow: hidden;
      box-shadow: var(--shadow-sm);
    }

    .review-card {
      background: var(--white);
      border-radius: var(--border-radius);
      padding: 20px;
      margin-bottom: 16px;
      box-shadow: var(--shadow-sm);
      transition: transform 0.2s;
    }

    .review-card:hover {
      transform: translateX(4px);
    }

    .review-header {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 12px;
    }

    .review-avatar {
      width: 48px;
      height: 48px;
      border-radius: 50%;
      object-fit: cover;
    }

    .review-author {
      font-weight: bold;
      margin-bottom: 2px;
    }

    .review-date {
      font-size: 0.85rem;
      color: var(--gray-600);
    }

    .review-stars {
      color: #ffc107;
      font-size: 1.1rem;
    }

    .photo-gallery {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 12px;
      margin-top: 20px;
    }

    .photo-item {
      aspect-ratio: 1;
      border-radius: var(--border-radius);
      overflow: hidden;
      cursor: pointer;
      transition: transform 0.3s;
    }

    .photo-item:hover {
      transform: scale(1.05);
    }

    .photo-item img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .add-photo-btn {
      background: var(--gray-100);
      border: 2px dashed var(--gray-300);
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      color: var(--gray-600);
      cursor: pointer;
      transition: all 0.3s;
    }

    .add-photo-btn:hover {
      background: #e2f0f9;
      border-color: var(--primary-color);
      color: var(--primary-color);
    }

    .action-buttons {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
    }

    .weather-forecast-card {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border-radius: 16px;
      padding: 24px;
      margin-bottom: 24px;
    }

    .forecast-cta {
      background: rgba(255,255,255,0.2);
      border: 2px solid rgba(255,255,255,0.4);
      color: white;
      padding: 12px 24px;
      border-radius: 24px;
      font-weight: bold;
      transition: all 0.3s;
    }

    .forecast-cta:hover {
      background: rgba(255,255,255,0.3);
      transform: translateY(-2px);
    }
  </style>
</head>
<body>
  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg shadow-sm">
    <div class="container-fluid">
      <a class="navbar-brand d-flex align-items-center" href="index.html">
        <img src="../assets/images/logo.jpg" alt="Logo" width="32" height="32" class="me-2">
        <span class="fw-bold">ActiveSky</span>
      </a>
      <div id="nav-auth">
        <a href="login.html" class="btn btn-outline-primary me-2">Registrarse</a>
        <a href="login.html" class="btn btn-outline-primary">Iniciar sesi√≥n</a>
      </div>
    </div>
  </nav>

  <!-- Loading State -->
  <div id="loading-state" class="container my-5 text-center">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Cargando...</span>
    </div>
    <p class="mt-3">Cargando informaci√≥n del lugar...</p>
  </div>

  <!-- Error State -->
  <div id="error-state" class="container my-5" style="display: none;">
    <div class="alert alert-danger">
      <h5>‚ùå Error al cargar el lugar</h5>
      <p id="error-message"></p>
      <a href="select.html" class="btn btn-primary">Volver a b√∫squeda</a>
    </div>
  </div>

  <!-- Main Content -->
  <div id="spot-content" class="container my-4" style="display: none;">
    <!-- Hero Image -->
    <div class="spot-hero" id="spot-hero">
      <div class="spot-hero-content">
        <h1 class="spot-hero-title" id="spot-title">Nombre del Lugar</h1>
        <div class="d-flex align-items-center gap-3">
          <div class="spot-rating-badge">
            <span class="star-rating-display">‚≠ê</span>
            <span id="spot-rating">0.0</span>
            <span class="text-muted">(<span id="spot-reviews-count">0</span>)</span>
          </div>
          <div class="text-white">
            <span id="spot-activity-icon">üìç</span>
            <span id="spot-activity-name">Actividad</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Weather Forecast CTA -->
    <div class="weather-forecast-card">
      <h4 class="mb-3">üå¶Ô∏è ¬øCu√°ndo planeas visitar este lugar?</h4>
      <p class="mb-3">Consulta el pron√≥stico clim√°tico basado en 30 a√±os de datos de NASA</p>
      <button class="btn forecast-cta" id="btn-check-weather">
        Consultar clima para este lugar
      </button>
    </div>

    <div class="row">
      <!-- Columna principal -->
      <div class="col-lg-8">
        <!-- Informaci√≥n b√°sica -->
        <div class="card mb-4">
          <div class="card-body">
            <h5 class="card-title fw-bold mb-3">üìç Informaci√≥n del Lugar</h5>
            <p id="spot-description" class="card-text text-muted">
              Sin descripci√≥n disponible.
            </p>
            
            <div class="info-grid">
              <div class="info-item">
                <div class="info-item-icon">üìç</div>
                <div class="info-item-label">Ubicaci√≥n</div>
                <div class="info-item-value" id="spot-location">Ciudad, Pa√≠s</div>
              </div>
              <div class="info-item">
                <div class="info-item-icon">üë•</div>
                <div class="info-item-label">Visitas</div>
                <div class="info-item-value" id="spot-visits">0</div>
              </div>
              <div class="info-item">
                <div class="info-item-icon">‚úÖ</div>
                <div class="info-item-label">Estado</div>
                <div class="info-item-value" id="spot-verified">No verificado</div>
              </div>
            </div>

            <div class="action-buttons mt-4">
              <button class="btn btn-primary" id="btn-add-visit">
                ‚úÖ Marcar como visitado
              </button>
              <button class="btn btn-outline-primary" id="btn-add-review">
                ‚≠ê Dejar rese√±a
              </button>
              <button class="btn btn-outline-secondary" id="btn-share">
                üîó Compartir
              </button>
            </div>
          </div>
        </div>

        <!-- Galer√≠a de fotos -->
        <div class="card mb-4">
          <div class="card-body">
            <div class="d-flex justify-content-between align-items-center mb-3">
              <h5 class="card-title fw-bold mb-0">üì∏ Galer√≠a de Fotos</h5>
              <button class="btn btn-sm btn-outline-primary" id="btn-upload-photo">
                üì§ Subir foto
              </button>
            </div>
            <div class="photo-gallery" id="photo-gallery">
              <!-- Fotos se cargar√°n din√°micamente -->
              <div class="photo-item add-photo-btn">
                <div>üì∑</div>
                <div>Agregar foto</div>
              </div>
            </div>
          </div>
        </div>

        <!-- Rese√±as -->
        <div class="card mb-4">
          <div class="card-body">
            <h5 class="card-title fw-bold mb-4">üí¨ Rese√±as de la Comunidad</h5>
            <div id="reviews-container">
              <!-- Rese√±as se cargar√°n din√°micamente -->
              <p class="text-muted">No hay rese√±as a√∫n. ¬°S√© el primero en dejar una!</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Sidebar -->
      <div class="col-lg-4">
        <!-- Mapa -->
        <div class="card mb-4">
          <div class="card-body">
            <h6 class="fw-bold mb-3">üó∫Ô∏è Ubicaci√≥n</h6>
            <div class="spot-map" id="spot-map"></div>
            <div class="mt-3">
              <small class="text-muted">
                Lat: <span id="spot-lat">0.0000</span>, 
                Lon: <span id="spot-lon">0.0000</span>
              </small>
            </div>
            <button class="btn btn-sm btn-outline-primary w-100 mt-2" id="btn-directions">
              üß≠ C√≥mo llegar
            </button>
          </div>
        </div>

        <!-- Creador del spot -->
        <div class="card mb-4">
          <div class="card-body">
            <h6 class="fw-bold mb-3">üë§ Agregado por</h6>
            <div class="d-flex align-items-center gap-2">
              <img id="creator-avatar" src="https://via.placeholder.com/48" alt="Avatar" class="rounded-circle" width="48" height="48">
              <div>
                <div class="fw-bold" id="creator-name">Usuario</div>
                <small class="text-muted" id="creator-date">Fecha</small>
              </div>
            </div>
          </div>
        </div>

        <!-- Spots cercanos -->
        <div class="card">
          <div class="card-body">
            <h6 class="fw-bold mb-3">üîç Lugares cercanos</h6>
            <div id="nearby-spots">
              <p class="text-muted small">Cargando lugares cercanos...</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal para agregar rese√±a -->
  <div class="modal fade" id="reviewModal" tabindex="-1">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">‚≠ê Dejar una Rese√±a</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <form id="review-form">
            <div class="mb-3">
              <label class="form-label">Calificaci√≥n</label>
              <div class="star-rating-input" id="star-rating">
                <span class="star" data-value="1">‚òÖ</span>
                <span class="star" data-value="2">‚òÖ</span>
                <span class="star" data-value="3">‚òÖ</span>
                <span class="star" data-value="4">‚òÖ</span>
                <span class="star" data-value="5">‚òÖ</span>
              </div>
              <input type="hidden" id="rating-value" value="5">
            </div>
            <div class="mb-3">
              <label for="review-comment" class="form-label">Comentario</label>
              <textarea class="form-control" id="review-comment" rows="4" placeholder="Comparte tu experiencia en este lugar..."></textarea>
            </div>
            <button type="submit" class="btn btn-primary w-100">Enviar Rese√±a</button>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal para subir foto -->
  <div class="modal fade" id="uploadPhotoModal" tabindex="-1">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">üì§ Subir Foto</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <form id="upload-photo-form">
            <div class="mb-3">
              <label for="photo-file" class="form-label">Seleccionar imagen</label>
              <input type="file" class="form-control" id="photo-file" accept="image/*" required>
            </div>
            <div class="mb-3">
              <label for="photo-caption" class="form-label">Descripci√≥n (opcional)</label>
              <input type="text" class="form-control" id="photo-caption" placeholder="Agrega una descripci√≥n...">
            </div>
            <button type="submit" class="btn btn-primary w-100">Subir Foto</button>
          </form>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"></script>
  <script src="../js/config.js"></script>
  <script>
    // Cargar Google Maps
    const script = document.createElement('script');
    script.src = `https://maps.googleapis.com/maps/api/js?key=${CONFIG.GOOGLE_MAPS_KEY}&callback=initSpotMap`;
    script.async = true;
    script.defer = true;
    document.head.appendChild(script);
  </script>
  <script src="../js/spot_detail.js"></script>
</body>
</html>